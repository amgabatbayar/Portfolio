<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio SQL</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            text-align: center;
        }
        header {
            background-color: #333;
            color: white;
            padding: 20px;
            font-size: 24px;
        }
        .container {
            width: 80%;
            margin: auto;
            padding: 20px;
        }
        .sql-project {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            text-align: left;
        }
        pre {
            background: #272822;
            color: #fff;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .result-table, th, td {
            border: 1px solid black;
            padding: 8px;
        }
        th {
            background-color: #333;
            color: white;
        }
    </style>
</head>
<body>
    <header>Portfolio SQL</header>
    <div class="container">
        <div class="sql-project">
            <h2>Projekt 1 Kaggle: supermarket_sales</h2>
            <p><strong>Opis:</strong> Projekt koncentruje się na analizie sprzedaży, zachowań klientów.</p>
            <p><strong>Link:</strong> https://www.kaggle.com/code/fareedalianwar/supermarket-sales</p>
            <pre>
--- Wczytanie danych

CREATE TEMPORARY TABLE tmp_main(
    Invoice_id TEXT,
    Branch TEXT,
    City TEXT,
    Customer_type TEXT,
    Gender TEXT,
    Product_line TEXT,
    Unit_price TEXT,
    Quantity TEXT,
    Tax5 TEXT,
    Total TEXT,
    Date TEXT,
    Time TEXT,
    Payment TEXT,
    cogs TEXT,
    gross_margin_percent TEXT,
    gross_income TEXT,
    Rating TEXT
);

COPY tmp_main FROM 'C:\Users\marcb\Desktop\archive\supermarket_sales.csv' DELIMITER ',' CSV HEADER;

CREATE TABLE main (
    Inv_id text,
    Branch TEXT,
    City TEXT,
    Custtype TEXT,
    Gender TEXT,
    Prod_line TEXT,
    Unit_price float,
    Quantity smallint,
    Tax5 float,
    Total float,
    trans_date DATE,
    Time TIME,
    Payment TEXT,
    cogs FLOAT,
    gross_margin_percent FLOAT,
    gross_income FLOAT,
    Rating FLOAT
);

INSERT INTO main(
    Inv_id,
    Branch,
    City,
    Custtype,
    Gender,
    Prod_line,
    Unit_price,
    Quantity,
    Tax5,
    Total,
    trans_date,
    Time,
    Payment,
    cogs,
    gross_margin_percent,
    gross_income,
    Rating
)
SELECT
    Invoice_id,
    Branch,
    City,
    Customer_type,
    Gender,
    Product_line,
    Unit_price::FLOAT,
    Quantity::SMALLINT,
    Tax5::FLOAT,
    Total::FLOAT,
    TO_DATE(Date, 'MM-DD-YYYY'),
    Time::TIME,
    Payment,
    cogs::FLOAT,
    gross_margin_percent::FLOAT,
    gross_income::FLOAT,
    Rating::FLOAT

FROM tmp_main;
            </pre>
            <h3>Wyniki:</h3>
            <table class="result-table">
                <tr>
                    <th>Produkt</th>
                    <th>Sprzedana Ilość</th>
                </tr>
                <tr>
                    <td>Telefon</td>
                    <td>120</td>
                </tr>
                <tr>
                    <td>Laptop</td>
                    <td>95</td>
                </tr>
            </table>
        </div>
    </div>
</body>
</html>
